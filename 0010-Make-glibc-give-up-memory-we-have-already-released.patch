diff -up shadow-4.19.0/src/login.c.3~ shadow-4.19.0/src/login.c
--- shadow-4.19.0/src/login.c.3~	2025-12-29 03:03:43.085315106 +0000
+++ shadow-4.19.0/src/login.c	2026-01-06 05:46:27.192074745 +0000
@@ -25,6 +25,7 @@
 #include <sys/stat.h>
 #include <sys/ioctl.h>
 #include <assert.h>
+#include <malloc.h>
 
 #include "alloc/malloc.h"
 #include "attr.h"
@@ -682,6 +683,7 @@ int main (int argc, char **argv)
 			}
 #endif
 
+			malloc_trim(0);
 			retcode = pam_authenticate (pamh, 0);
 
 			get_pam_user (&pam_user);
